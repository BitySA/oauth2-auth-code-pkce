<script>let module = {};</script>
<script src="../oauth2-auth-code-pkce.js"></script>
<script>
const { OAuth2AuthCodePKCE } = module.exports;

OAuth2AuthCodePKCE
  .isComingBackFromAuthServer()
  .then((oauth) => oauth.getAccessToken((fetchNewGrant) => {
    alert('Grant expired!');
    return fetchNewGrant();
  }))
  .then((token) => console.log(token))
  .catch((potentialError) => {
    if (potentialError) {
      alert(potentialError);
      return;
    }

    (new OAuth2AuthCodePKCE())
      .setConfig({
        authorizationUrl: 'https://connect.bity.io/oauth2/auth',
        tokenUrl: 'https://connect.bity.io/oauth2/token',
        clientId: '5c651cb1-1a4a-4e8b-84fc-f296f878a947',
        scopes: ['https://auth.bity.io/scopes/exchange.place'],
        redirectUrl: 'http://localhost:8080/examples/as-an-es6-browser-module.html'
      })
      .fetchAuthorizationGrant();
  });
</script>
